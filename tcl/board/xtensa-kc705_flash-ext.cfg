# SPDX-License-Identifier: GPL-2.0-or-later
# Cadence KC705 FPGA Development Platform for Xtensa targets
# Can be used with various external adapters, e.g. Flyswatter2 or JLink
#

adapter speed 10000

# KC705 supports JTAG only
transport select jtag

# Create Xtensa target first
source [find target/xtensa.cfg]

# Work-area is a space in RAM used for flash programming
# By default use 4kB
if { [info exists WORKAREASIZE] } {
   set _WORKAREASIZE $WORKAREASIZE
} else {
   set _WORKAREASIZE 0x1000
}

# Work-are location depends on configuration system memory location
if { [info exists WORKAREAADDR] } {
   set _WORKAREAADDR $WORKAREAADDR
} else {
   set _WORKAREAADDR 0x61000000
}

# Allow overriding the Flash bank size
if { [info exists FLASH_SIZE] } {
    set _FLASH_SIZE $FLASH_SIZE
} else {
    # Set 16MB of flash by default for compatibility with ML605/KC705
    set _FLASH_SIZE 0x01000000
}

# Work area location
$_TARGETNAME configure -work-area-phys $_WORKAREAADDR -work-area-size $_WORKAREASIZE -work-area-backup 0

# flash size will be probed
set _FLASHNAME $_CHIPNAME.flash
flash bank $_FLASHNAME xtkcml705fl 0x90000000 $_FLASH_SIZE 0 0 $_TARGETNAME

